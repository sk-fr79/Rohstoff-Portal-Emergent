CREATE OR REPLACE VIEW V#MANDANT#_MATSPEZ_4_SELECTION
(
ID_ADRESSE
,IST_LIEFERANT
,IST_ABNEHMER
,SOLL_IST_STATUS
,ID_ARTIKEL
,ID_MAT_ELEMENT
,ID_MAT_SPEZ
,ID_ELEMENT
,INFOTEXT
,WERT_UNTEN
,WERT_OBEN
,DEFANTEIL
,ANTEILMIN
,ANTEIL
) 
AS
( 
SELECT 
MS.ID_ADRESSE
,MS.IST_LIEFERANT
,MS.IST_ABNEHMER
,MS.SOLL_IST_STATUS
,MS.ID_ARTIKEL
,ME.ID_MAT_ELEMENT
,ME.ID_MAT_SPEZ
,ME.ID_ELEMENT
,ME.INFOTEXT
,
(CASE 
  WHEN ME.DEFANTEIL='EXACT' THEN
     NVL(ME.ANTEIL,0)
  WHEN ME.DEFANTEIL='VONBIS' THEN
     NVL(ME.ANTEILMIN,0)
  WHEN   ME.DEFANTEIL='MINIMAL' THEN
     NVL(ME.ANTEIL,0)
  WHEN   ME.DEFANTEIL='MAXIMAL' THEN
     0
   ELSE
     100
END) AS WERT_UNTEN,

(CASE 
  WHEN ME.DEFANTEIL='EXACT' THEN
     NVL(ME.ANTEIL,0)
  WHEN ME.DEFANTEIL='VONBIS' THEN
     NVL(ME.ANTEIL,0)
  WHEN   ME.DEFANTEIL='MINIMAL' THEN
     100
  WHEN  ME.DEFANTEIL='MAXIMAL' THEN
     NVL(ME.ANTEIL,0)
  ELSE
     0   
END) AS WERT_OBEN

,ME.DEFANTEIL
,ME.ANTEILMIN
,ME.ANTEIL

 FROM JT_MAT_ELEMENT ME
 INNER JOIN JT_MAT_SPEZ MS ON (MS.ID_MAT_SPEZ=ME.ID_MAT_SPEZ)
 WHERE ME.ID_MANDANT=#MANDANT#
 )
 
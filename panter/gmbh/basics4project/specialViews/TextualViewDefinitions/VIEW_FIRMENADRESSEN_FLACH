CREATE OR REPLACE VIEW V_FIRMENADRESSEN_FLACH AS 
SELECT * 
FROM JT_ADRESSE A 

INNER JOIN (
       
        SELECT  ID_ADRESSE 		AS ID_ADRESSE_BASIS, 
                ID_ADRESSE  	AS ID_ADRESSE_LIEFER, 
                null 			AS ID_ADRESSE_FREMDWARE,
                null 			AS REGISTERFUEHRUNG,
                null 			AS LAGER_VERBUCHUNG,
                ID_MANDANT 		AS ID_MANDANT_ADRESSE,
                null			AS LIEFERADRESSE_BESCHREIBUNG
                FROM JT_ADRESSE WHERE ADRESSTYP = 1
        UNION 
       
        SELECT  LA.ID_ADRESSE_BASIS, 
                LA.ID_ADRESSE_LIEFER, 
                LA.ID_ADRESSE_FREMDWARE,
                LA.REGISTERFUEHRUNG,
                LA.LAGER_VERBUCHUNG,
                LA.ID_MANDANT AS ID_MANDANT_ADRESSE,
                LA.BESCHREIBUNG	AS LIEFERADRESSE_BESCHREIBUNG
                FROM JT_LIEFERADRESSE LA 
                
) ON A.ID_ADRESSE = ID_ADRESSE_LIEFER AND A.ID_MANDANT = ID_MANDANT_ADRESSE

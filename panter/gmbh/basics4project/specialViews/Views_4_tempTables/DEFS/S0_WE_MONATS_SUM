CREATE OR REPLACE VIEW 
S#MANDANT#_WE_MONATS_SUM
(
SUM_MENGE,
SUM_ABZUG_MENGE,
SUM_GESAMTPREIS,
SUM_GPREIS_ABZUG_MGE,
SUM_GPREIS_ABZUG_AUF_NETTOMGE,
SUM_GESAMTPREIS_NETTO,
SUM_KOSTEN_TRANSPORT_WE,
SUM_KOSTEN_PRODUKT_WE,
SUM_KOSTEN_TRANSPORT_WA,
SUM_KOSTEN_PRODUKT_WA,
ID_ADRESSE,
LEISTUNGSDATUM_MONAT_JAHR,
ID_ARTIKEL,
ID_EINHEIT,
LIEFERBEDINGUNGEN,
VARIANTE,
KENNUNGSFELD_WE_WA
)
AS
(
SELECT
SUM(NVL(MENGE,0)) AS SUM_MENGE,
SUM(NVL(ABZUG_MENGE,0)) AS SUM_ABZUG_MENGE,
SUM(NVL(GESAMTPREIS,0)) AS SUM_GESAMTPREIS,
SUM(NVL(GPREIS_ABZ_MGE,0)) AS SUM_GPREIS_ABZ_MGE,
SUM(NVL(GPREIS_ABZ_AUF_NETTOMGE,0)) AS SUM_GPREIS_ABZ_AUF_NETTOMGE,
SUM(NVL(GESAMTPREIS,0)-NVL(GPREIS_ABZ_MGE,0)-NVL(GPREIS_ABZ_AUF_NETTOMGE,0)) AS SUM_GESAMTPREIS_NETTO,
SUM(NVL(KOSTEN_TRANSPORT_WE,0)) AS SUM_KOSTEN_TRANSPORT_WE,
SUM(NVL(KOSTEN_PRODUKT_WE,0)) AS SUM_KOSTEN_PRODUKT_WE,
SUM(NVL(KOSTEN_TRANSPORT_WA,0)) AS SUM_KOSTEN_TRANSPORT_WA,
SUM(NVL(KOSTEN_PRODUKT_WA,0)) AS SUM_KOSTEN_PRODUKT_WA,
ID_ADRESSE_BASIS,
LEISTUNGSDATUM_MONAT_JAHR,
ID_ARTIKEL,
ID_EINHEIT,
LIEFERBEDINGUNGEN,
VARIANTE,
'WE'
FROM S#MANDANT#_WE_ATOM
GROUP BY ID_ADRESSE_BASIS,LEISTUNGSDATUM_MONAT_JAHR,ID_ARTIKEL,ID_EINHEIT,LIEFERBEDINGUNGEN,VARIANTE
)

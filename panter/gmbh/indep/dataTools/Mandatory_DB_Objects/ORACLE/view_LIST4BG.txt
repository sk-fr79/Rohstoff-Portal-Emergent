CREATE OR REPLACE VIEW #VIEW#
AS
(

SELECT
 NVL(ID_V1,ID_V2) AS ID_BG_VEKTOR
 ,ID_BG_ATOM_START
 ,ID_BG_LADUNG_START
 ,ID_BG_STATION_START
 ,ID_ADRESSE_START
 ,ID_BG_ATOM_ZIEL
 ,ID_BG_LADUNG_ZIEL
 ,ID_BG_STATION_ZIEL
 ,ID_ADRESSE_ZIEL
 

 FROM (

(
SELECT BGV.ID_BG_VEKTOR AS ID_V1, A.ID_BG_ATOM AS ID_BG_ATOM_START, L.ID_BG_LADUNG AS ID_BG_LADUNG_START, S.ID_BG_STATION AS ID_BG_STATION_START,  AD.ID_ADRESSE AS ID_ADRESSE_START  FROM JT_BG_VEKTOR BGV
INNER JOIN JT_BG_ATOM    A  ON (BGV.ID_BG_VEKTOR       =    A.ID_BG_VEKTOR    AND   A.EN_ATOM_TYP='HAUPTATOM')
INNER JOIN JT_BG_LADUNG  L  ON (A.ID_BG_ATOM           =    L.ID_BG_ATOM      AND   L.MENGENVORZEICHEN=-1)
INNER JOIN JT_BG_STATION S  ON (S.ID_BG_STATION        =    L.ID_BG_STATION)
INNER JOIN JT_ADRESSE   AD  ON (AD.ID_ADRESSE          =    S.ID_ADRESSE)
WHERE AD.SONDERLAGER IS NULL AND BGV.ID_MANDANT=#ID_MANDANT#
)
FULL OUTER JOIN 
(
SELECT BGV.ID_BG_VEKTOR AS ID_V2, A.ID_BG_ATOM AS ID_BG_ATOM_ZIEL, L.ID_BG_LADUNG AS ID_BG_LADUNG_ZIEL, S.ID_BG_STATION AS ID_BG_STATION_ZIEL,  AD.ID_ADRESSE AS ID_ADRESSE_ZIEL FROM JT_BG_VEKTOR BGV
INNER JOIN  JT_BG_ATOM    A ON  (BGV.ID_BG_VEKTOR      =    A.ID_BG_VEKTOR   AND   A.EN_ATOM_TYP='HAUPTATOM')
INNER JOIN  JT_BG_LADUNG  L ON  (A.ID_BG_ATOM          =    L.ID_BG_ATOM     AND   L.MENGENVORZEICHEN=1)
INNER JOIN  JT_BG_STATION S ON  (S.ID_BG_STATION       =    L.ID_BG_STATION)
INNER JOIN  JT_ADRESSE   AD ON  (AD.ID_ADRESSE         =    S.ID_ADRESSE)
WHERE AD.SONDERLAGER IS NULL AND BGV.ID_MANDANT=#ID_MANDANT#
)
ON ( ID_V1=ID_V2)
)
)

